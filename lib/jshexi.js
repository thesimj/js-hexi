"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 * Copyright (c) 2017, Bubelich Mykola
 * https://www.bubelich.com
 *
 * (｡◕‿‿◕｡)
 *
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * Neither the name of the copyright holder nor the names of its contributors
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

/** Base 16 Alphabet **/
var _JENCB16 = "0123456789abcdef";
var _JDECB16 = [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, -1, -1, -1, -1, -1, -1, -1, 10, 11, 12, 13, 14, 15, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 10, 11, 12, 13, 14, 15];

/** Base 64 Alphabet **/
var _JENCB64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
var _JDECB64 = [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, 62, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, 63, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51];

/**
 *
 */

var JSHexi = function () {
  function JSHexi() {
    _classCallCheck(this, JSHexi);
  }

  _createClass(JSHexi, null, [{
    key: "fromBase16",

    /**
     * Decode input string in Base16 to array of byte.
     *
     * @param {String} data
     * @return {Uint8Array}
     */
    value: function fromBase16(data) {
      JSHexi._checkLength(data.length, 2);

      var result = new Uint8Array(data.length >> 1);
      var code_a = void 0,
          code_b = void 0;

      for (var i = 0; i < result.length; i++) {
        code_a = data.charCodeAt(2 * i);
        code_b = data.charCodeAt(2 * i + 1);

        result[i] = _JDECB16[code_a] << 4 | _JDECB16[code_b];
      }

      return result;
    }

    /**
     * Decode input string in Base64 to array of byte.
     *
     * @param {String} data
     * @return {Uint8Array}
     */

  }, {
    key: "fromBase64",
    value: function fromBase64(data) {

      var dlen = data.length;
      var rlen = dlen * 3 / 4;

      if (dlen % 2 == 0) {
        if (data[dlen - 1] === "=") {
          dlen--;
          rlen--;
        }

        if (data[dlen - 1] === "=") {
          dlen--;
          rlen--;
        }
      }

      var result = new Uint8Array(rlen);
      var dcounter = 0,
          rcounter = 0,
          buff = void 0,
          code_a = void 0,
          code_b = void 0,
          code_c = void 0,
          code_d = void 0;

      while (dlen >= 4) {

        code_a = data.charCodeAt(dcounter++);
        code_b = data.charCodeAt(dcounter++);
        code_c = data.charCodeAt(dcounter++);
        code_d = data.charCodeAt(dcounter++);

        buff = _JDECB64[code_a] << 18 | _JDECB64[code_b] << 12 | _JDECB64[code_c] << 6 | _JDECB64[code_d];

        result[rcounter++] = buff >> 16 & 0xFF;
        result[rcounter++] = buff >> 8 & 0xFF;
        result[rcounter++] = buff & 0xFF;

        dlen -= 4;
      }

      // Padding stage //
      switch (rlen - rcounter) {
        case 2:
          {
            buff = _JDECB64[data.charCodeAt(dcounter++)] << 18 | _JDECB64[data.charCodeAt(dcounter++)] << 12 | _JDECB64[data.charCodeAt(dcounter++)] << 6;

            result[rcounter++] = buff >> 16 & 0xFF;
            result[rcounter++] = buff >> 8 & 0xFF;

            break;
          }

        case 1:
          {
            buff = _JDECB64[data.charCodeAt(dcounter++)] << 18 | _JDECB64[data.charCodeAt(dcounter++)] << 12;

            result[rcounter++] = buff >> 16 & 0xFF;

            break;
          }
      }

      return result;
    }

    /**
     * Encode input byte array as Base64 string
     *
     * @param {Uint8Array} data
     * @return {String}
     */

  }, {
    key: "toBase64",
    value: function toBase64(data) {
      JSHexi._checkForUint8Array(data);

      var dlen = data.length;
      var result = "",
          buff = void 0,
          dcounter = 0;

      while (dlen >= 3) {
        buff = data[dcounter++] << 16 | data[dcounter++] << 8 | data[dcounter++];

        result += _JENCB64[buff >> 18 & 0x3F];
        result += _JENCB64[buff >> 12 & 0x3F];
        result += _JENCB64[buff >> 6 & 0x3F];
        result += _JENCB64[buff & 0x3F];

        dlen -= 3;
      }

      // Padding stage //
      switch (dlen) {
        case 2:
          {
            buff = data[dcounter++] << 16 | data[dcounter++] << 8;
            result += _JENCB64[buff >> 18 & 0x3F];
            result += _JENCB64[buff >> 12 & 0x3F];
            result += _JENCB64[buff >> 6 & 0x3F];
            result += "=";

            break;
          }

        case 1:
          {
            buff = data[dcounter++] << 16;
            result += _JENCB64[buff >> 18 & 0x3F];
            result += _JENCB64[buff >> 12 & 0x3F];
            result += "==";

            break;
          }
      }

      return result;
    }

    /**
     * Encode input byte array as Base16 string
     *
     * @param {Uint8Array} data
     * @return {String}
     */

  }, {
    key: "toBase16",
    value: function toBase16(data) {
      JSHexi._checkForUint8Array(data);

      var result = "";

      for (var i = 0; i < data.length; i++) {
        result = result.concat(_JENCB16[data[i] >>> 4], _JENCB16[data[i] & 0x0F]);
      }

      return result;
    }

    /**
     * Checks if unicode chars in data string
     *
     * @param {String} data
     * @return {boolean}
     */

  }, {
    key: "isUnicodeString",
    value: function isUnicodeString(data) {
      for (var i = 0; i < data.length; i++) {
        if (data.charCodeAt(i) > 0xFF) {
          return true;
        }
      }

      return false;
    }

    /**
     * Convert string data to bytes
     *
     * @throws {Error} when data contain unicode char, but unicode flag set to false
     * @param {String} data
     * @param {Boolean} unicode
     * @return {Uint8Array}
     */

  }, {
    key: "toBytes",
    value: function toBytes(data) {
      var unicode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      JSHexi._checkForUnicode(data, unicode);

      var buffer = new Uint8Array(unicode ? data.length << 1 : data.length);
      var i = void 0,
          code = void 0;

      for (i = 0; i < data.length; i++) {
        code = data.charCodeAt(i);

        if (unicode) {
          buffer[i * 2] = code >> 8 & 0xFF;
          buffer[i * 2 + 1] = code & 0xFF;
        } else {
          buffer[i] = code;
        }
      }

      return buffer;
    }

    /**
     * Convert bytes to string, can be unicode string
     *
     * @param {Uint8Array} data
     * @param {Boolean} unicode
     */

  }, {
    key: "fromBytes",
    value: function fromBytes(data) {
      var unicode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      JSHexi._checkForUint8Array(data);

      var udata = unicode ? new Uint16Array(data.length / 2) : data;

      if (unicode) {
        for (var i = 0; i < udata.length; i++) {
          udata[i] = (data[2 * i] << 8 | data[2 * i + 1]) & 0xFFFF;
        }
      }

      return String.fromCodePoint.apply(String, _toConsumableArray(udata));
    }

    /**
     * Check input string for unicode char
     * If found unicode char, throw error
     *
     * @throws {Error}
     * @param {String} data
     * @param {Boolean} unicode
     * @private
     */

  }, {
    key: "_checkForUnicode",
    value: function _checkForUnicode(data) {
      var unicode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (!unicode && JSHexi.isUnicodeString(data)) {
        throw new Error("Unicode char in data!");
      }
    }

    /**
     * Check length by module
     *
     * @param length
     * @param mod
     * @private
     */

  }, {
    key: "_checkLength",
    value: function _checkLength(length, mod) {
      if (length % mod !== 0) {
        throw new Error("Data string has wrong length!");
      }
    }

    /**
     * Check for input if this byte array.
     * If not, throws Error
     *
     * @throws {Error}
     * @param {*} data
     * @private
     */

  }, {
    key: "_checkForUint8Array",
    value: function _checkForUint8Array(data) {
      if (!(data instanceof Uint8Array)) {
        throw new Error("Data not byte array!");
      }
    }
  }]);

  return JSHexi;
}();

/** Exports **/


exports.default = JSHexi;
module.exports = exports["default"];

//# sourceMappingURL=data:application/json;base64,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QWtDLEdBQWxDLEVBQXVDO0FBQ3JDLGdCQUFNLENBQU4sSUFBVyxDQUFFLEtBQUssSUFBSSxDQUFULEtBQWUsQ0FBaEIsR0FBc0IsS0FBSyxJQUFJLENBQUosR0FBUSxDQUFiLENBQXZCLElBQTJDLE1BQXREO0FBQ0Q7QUFDRjs7QUFFRCxhQUFPLE9BQU8sYUFBUCxrQ0FBd0IsS0FBeEIsRUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7cUNBU3dCLEksRUFBc0I7QUFBQSxVQUFoQixPQUFnQix1RUFBTixJQUFNOztBQUM1QyxVQUFJLENBQUMsT0FBRCxJQUFZLE9BQU8sZUFBUCxDQUF1QixJQUF2QixDQUFoQixFQUE4QztBQUM1QyxjQUFNLElBQUksS0FBSixDQUFVLHVCQUFWLENBQU47QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7O2lDQU9vQixNLEVBQVEsRyxFQUFLO0FBQy9CLFVBQUksU0FBUyxHQUFULEtBQWlCLENBQXJCLEVBQXdCO0FBQ3RCLGNBQU0sSUFBSSxLQUFKLENBQVUsK0JBQVYsQ0FBTjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozs7O3dDQVEyQixJLEVBQU07QUFDL0IsVUFBSSxFQUFFLGdCQUFnQixVQUFsQixDQUFKLEVBQW1DO0FBQ2pDLGNBQU0sSUFBSSxLQUFKLENBQVUsc0JBQVYsQ0FBTjtBQUNEO0FBQ0Y7Ozs7OztBQUdIOzs7a0JBQ2UsTSIsImZpbGUiOiJqc2hleGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LCBCdWJlbGljaCBNeWtvbGFcbiAqIGh0dHBzOi8vd3d3LmJ1YmVsaWNoLmNvbVxuICpcbiAqICjvvaHil5XigL/igL/il5XvvaEpXG4gKlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICpcbiAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiAqIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKlxuICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuICogdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvblxuICogYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4gKlxuICogTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUgY29weXJpZ2h0IGhvbGRlciBub3IgdGhlIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnNcbiAqIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0XG4gKiBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKlxuICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUiBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICogQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICogSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAqIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRVxuICogTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUlxuICogQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0ZcbiAqIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTU1xuICogSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU5cbiAqIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRVxuICogUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKi9cblxuLyoqIEJhc2UgMTYgQWxwaGFiZXQgKiovXG5jb25zdCBfSkVOQ0IxNiA9IFwiMDEyMzQ1Njc4OWFiY2RlZlwiO1xuY29uc3QgX0pERUNCMTYgPSBbXG4gIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLFxuICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSxcbiAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsXG4gIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLFxuICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDAsIDEsXG4gIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIC0xLCAtMSwgLTEsIC0xLFxuICAtMSwgLTEsIC0xLCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAtMSxcbiAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsXG4gIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLFxuICAtMSwgLTEsIC0xLCAtMSwgLTEsIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTVcbl07XG5cbi8qKiBCYXNlIDY0IEFscGhhYmV0ICoqL1xuY29uc3QgX0pFTkNCNjQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCI7XG5jb25zdCBfSkRFQ0I2NCA9IFtcbiAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLFxuICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsXG4gIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDYyLCAtMSwgNjIsIC0xLCA2MywgNTIsIDUzLCA1NCxcbiAgNTUsIDU2LCA1NywgNTgsIDU5LCA2MCwgNjEsIC0xLCAtMSwgLTEsIDAsIC0xLCAtMSwgLTEsIDAsIDEsIDIsIDMsIDQsXG4gIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5LCAyMCwgMjEsIDIyLCAyMyxcbiAgMjQsIDI1LCAtMSwgLTEsIC0xLCAtMSwgNjMsIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LFxuICAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTFcbl07XG5cbi8qKlxuICpcbiAqL1xuY2xhc3MgSlNIZXhpIHtcbiAgLyoqXG4gICAqIERlY29kZSBpbnB1dCBzdHJpbmcgaW4gQmFzZTE2IHRvIGFycmF5IG9mIGJ5dGUuXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhXG4gICAqIEByZXR1cm4ge1VpbnQ4QXJyYXl9XG4gICAqL1xuICBzdGF0aWMgZnJvbUJhc2UxNihkYXRhKSB7XG4gICAgSlNIZXhpLl9jaGVja0xlbmd0aChkYXRhLmxlbmd0aCwgMik7XG5cbiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCA+PiAxKTtcbiAgICBsZXQgY29kZV9hLCBjb2RlX2I7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgY29kZV9hID0gZGF0YS5jaGFyQ29kZUF0KDIgKiBpKTtcbiAgICAgIGNvZGVfYiA9IGRhdGEuY2hhckNvZGVBdCgyICogaSArIDEpO1xuXG4gICAgICByZXN1bHRbaV0gPSBfSkRFQ0IxNltjb2RlX2FdIDw8IDQgfCBfSkRFQ0IxNltjb2RlX2JdO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogRGVjb2RlIGlucHV0IHN0cmluZyBpbiBCYXNlNjQgdG8gYXJyYXkgb2YgYnl0ZS5cbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGFcbiAgICogQHJldHVybiB7VWludDhBcnJheX1cbiAgICovXG4gIHN0YXRpYyBmcm9tQmFzZTY0KGRhdGEpIHtcblxuICAgIGxldCBkbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgbGV0IHJsZW4gPSBkbGVuICogMyAvIDQ7XG5cbiAgICBpZiAoZGxlbiAlIDIgPT0gMCkge1xuICAgICAgaWYgKGRhdGFbZGxlbiAtIDFdID09PSBcIj1cIikge1xuICAgICAgICBkbGVuLS07XG4gICAgICAgIHJsZW4tLTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGFbZGxlbiAtIDFdID09PSBcIj1cIikge1xuICAgICAgICBkbGVuLS07XG4gICAgICAgIHJsZW4tLTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShybGVuKTtcbiAgICBsZXQgZGNvdW50ZXIgPSAwLCByY291bnRlciA9IDAsIGJ1ZmYsIGNvZGVfYSwgY29kZV9iLCBjb2RlX2MsIGNvZGVfZDtcblxuICAgIHdoaWxlIChkbGVuID49IDQpIHtcblxuICAgICAgY29kZV9hID0gZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspO1xuICAgICAgY29kZV9iID0gZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspO1xuICAgICAgY29kZV9jID0gZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspO1xuICAgICAgY29kZV9kID0gZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspO1xuXG4gICAgICBidWZmID0gX0pERUNCNjRbY29kZV9hXSA8PCAxOCB8XG4gICAgICAgIF9KREVDQjY0W2NvZGVfYl0gPDwgMTIgfFxuICAgICAgICBfSkRFQ0I2NFtjb2RlX2NdIDw8IDYgfFxuICAgICAgICBfSkRFQ0I2NFtjb2RlX2RdO1xuXG4gICAgICByZXN1bHRbcmNvdW50ZXIrK10gPSAoYnVmZiA+PiAxNikgJiAweEZGO1xuICAgICAgcmVzdWx0W3Jjb3VudGVyKytdID0gKGJ1ZmYgPj4gOCkgJiAweEZGO1xuICAgICAgcmVzdWx0W3Jjb3VudGVyKytdID0gYnVmZiAmIDB4RkY7XG5cbiAgICAgIGRsZW4gLT0gNDtcbiAgICB9XG5cbiAgICAvLyBQYWRkaW5nIHN0YWdlIC8vXG4gICAgc3dpdGNoIChybGVuIC0gcmNvdW50ZXIpIHtcbiAgICAgIGNhc2UgMjoge1xuICAgICAgICBidWZmID0gX0pERUNCNjRbZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspXSA8PCAxOCB8XG4gICAgICAgICAgX0pERUNCNjRbZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspXSA8PCAxMiB8XG4gICAgICAgICAgX0pERUNCNjRbZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspXSA8PCA2O1xuXG4gICAgICAgIHJlc3VsdFtyY291bnRlcisrXSA9IChidWZmID4+IDE2KSAmIDB4RkY7XG4gICAgICAgIHJlc3VsdFtyY291bnRlcisrXSA9IChidWZmID4+IDgpICYgMHhGRjtcblxuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAxIDoge1xuICAgICAgICBidWZmID0gX0pERUNCNjRbZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspXSA8PCAxOCB8XG4gICAgICAgICAgX0pERUNCNjRbZGF0YS5jaGFyQ29kZUF0KGRjb3VudGVyKyspXSA8PCAxMjtcblxuICAgICAgICByZXN1bHRbcmNvdW50ZXIrK10gPSAoYnVmZiA+PiAxNikgJiAweEZGO1xuXG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogRW5jb2RlIGlucHV0IGJ5dGUgYXJyYXkgYXMgQmFzZTY0IHN0cmluZ1xuICAgKlxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IGRhdGFcbiAgICogQHJldHVybiB7U3RyaW5nfVxuICAgKi9cbiAgc3RhdGljIHRvQmFzZTY0KGRhdGEpIHtcbiAgICBKU0hleGkuX2NoZWNrRm9yVWludDhBcnJheShkYXRhKTtcblxuICAgIGxldCBkbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgbGV0IHJlc3VsdCA9IFwiXCIsIGJ1ZmYsIGRjb3VudGVyID0gMDtcblxuICAgIHdoaWxlIChkbGVuID49IDMpIHtcbiAgICAgIGJ1ZmYgPSBkYXRhW2Rjb3VudGVyKytdIDw8IDE2IHwgZGF0YVtkY291bnRlcisrXSA8PCA4IHwgZGF0YVtkY291bnRlcisrXTtcblxuICAgICAgcmVzdWx0ICs9IF9KRU5DQjY0W2J1ZmYgPj4gMTggJiAweDNGXTtcbiAgICAgIHJlc3VsdCArPSBfSkVOQ0I2NFtidWZmID4+IDEyICYgMHgzRl07XG4gICAgICByZXN1bHQgKz0gX0pFTkNCNjRbYnVmZiA+PiA2ICYgMHgzRl07XG4gICAgICByZXN1bHQgKz0gX0pFTkNCNjRbYnVmZiAmIDB4M0ZdO1xuXG4gICAgICBkbGVuIC09IDM7XG4gICAgfVxuXG4gICAgLy8gUGFkZGluZyBzdGFnZSAvL1xuICAgIHN3aXRjaCAoZGxlbikge1xuICAgICAgY2FzZSAyIDoge1xuICAgICAgICBidWZmID0gZGF0YVtkY291bnRlcisrXSA8PCAxNiB8IGRhdGFbZGNvdW50ZXIrK10gPDwgODtcbiAgICAgICAgcmVzdWx0ICs9IF9KRU5DQjY0W2J1ZmYgPj4gMTggJiAweDNGXTtcbiAgICAgICAgcmVzdWx0ICs9IF9KRU5DQjY0W2J1ZmYgPj4gMTIgJiAweDNGXTtcbiAgICAgICAgcmVzdWx0ICs9IF9KRU5DQjY0W2J1ZmYgPj4gNiAmIDB4M0ZdO1xuICAgICAgICByZXN1bHQgKz0gXCI9XCI7XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgYnVmZiA9IGRhdGFbZGNvdW50ZXIrK10gPDwgMTY7XG4gICAgICAgIHJlc3VsdCArPSBfSkVOQ0I2NFtidWZmID4+IDE4ICYgMHgzRl07XG4gICAgICAgIHJlc3VsdCArPSBfSkVOQ0I2NFtidWZmID4+IDEyICYgMHgzRl07XG4gICAgICAgIHJlc3VsdCArPSBcIj09XCI7XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbmNvZGUgaW5wdXQgYnl0ZSBhcnJheSBhcyBCYXNlMTYgc3RyaW5nXG4gICAqXG4gICAqIEBwYXJhbSB7VWludDhBcnJheX0gZGF0YVxuICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAqL1xuICBzdGF0aWMgdG9CYXNlMTYoZGF0YSkge1xuICAgIEpTSGV4aS5fY2hlY2tGb3JVaW50OEFycmF5KGRhdGEpO1xuXG4gICAgbGV0IHJlc3VsdCA9IFwiXCI7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoX0pFTkNCMTZbZGF0YVtpXSA+Pj4gNF0sIF9KRU5DQjE2W2RhdGFbaV0gJiAweDBGXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdW5pY29kZSBjaGFycyBpbiBkYXRhIHN0cmluZ1xuICAgKlxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgc3RhdGljIGlzVW5pY29kZVN0cmluZyhkYXRhKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoZGF0YS5jaGFyQ29kZUF0KGkpID4gMHhGRikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBzdHJpbmcgZGF0YSB0byBieXRlc1xuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gd2hlbiBkYXRhIGNvbnRhaW4gdW5pY29kZSBjaGFyLCBidXQgdW5pY29kZSBmbGFnIHNldCB0byBmYWxzZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IHVuaWNvZGVcbiAgICogQHJldHVybiB7VWludDhBcnJheX1cbiAgICovXG4gIHN0YXRpYyB0b0J5dGVzKGRhdGEsIHVuaWNvZGUgPSB0cnVlKSB7XG4gICAgSlNIZXhpLl9jaGVja0ZvclVuaWNvZGUoZGF0YSwgdW5pY29kZSk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheSh1bmljb2RlID8gZGF0YS5sZW5ndGggPDwgMSA6IGRhdGEubGVuZ3RoKTtcbiAgICBsZXQgaSwgY29kZTtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb2RlID0gZGF0YS5jaGFyQ29kZUF0KGkpO1xuXG4gICAgICBpZiAodW5pY29kZSkge1xuICAgICAgICBidWZmZXJbaSAqIDJdID0gKGNvZGUgPj4gOCkgJiAweEZGO1xuICAgICAgICBidWZmZXJbaSAqIDIgKyAxXSA9IGNvZGUgJiAweEZGO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnVmZmVyW2ldID0gY29kZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgYnl0ZXMgdG8gc3RyaW5nLCBjYW4gYmUgdW5pY29kZSBzdHJpbmdcbiAgICpcbiAgICogQHBhcmFtIHtVaW50OEFycmF5fSBkYXRhXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gdW5pY29kZVxuICAgKi9cbiAgc3RhdGljIGZyb21CeXRlcyhkYXRhLCB1bmljb2RlID0gdHJ1ZSkge1xuICAgIEpTSGV4aS5fY2hlY2tGb3JVaW50OEFycmF5KGRhdGEpO1xuXG4gICAgY29uc3QgdWRhdGEgPSAodW5pY29kZSkgPyBuZXcgVWludDE2QXJyYXkoZGF0YS5sZW5ndGggLyAyKSA6IGRhdGE7XG5cbiAgICBpZiAodW5pY29kZSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1ZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICB1ZGF0YVtpXSA9ICgoZGF0YVsyICogaV0gPDwgOCkgfCAoZGF0YVsyICogaSArIDFdKSkgJiAweEZGRkY7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KC4uLnVkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpbnB1dCBzdHJpbmcgZm9yIHVuaWNvZGUgY2hhclxuICAgKiBJZiBmb3VuZCB1bmljb2RlIGNoYXIsIHRocm93IGVycm9yXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfVxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IHVuaWNvZGVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHN0YXRpYyBfY2hlY2tGb3JVbmljb2RlKGRhdGEsIHVuaWNvZGUgPSB0cnVlKSB7XG4gICAgaWYgKCF1bmljb2RlICYmIEpTSGV4aS5pc1VuaWNvZGVTdHJpbmcoZGF0YSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaWNvZGUgY2hhciBpbiBkYXRhIVwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgbGVuZ3RoIGJ5IG1vZHVsZVxuICAgKlxuICAgKiBAcGFyYW0gbGVuZ3RoXG4gICAqIEBwYXJhbSBtb2RcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHN0YXRpYyBfY2hlY2tMZW5ndGgobGVuZ3RoLCBtb2QpIHtcbiAgICBpZiAobGVuZ3RoICUgbW9kICE9PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEYXRhIHN0cmluZyBoYXMgd3JvbmcgbGVuZ3RoIVwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgZm9yIGlucHV0IGlmIHRoaXMgYnl0ZSBhcnJheS5cbiAgICogSWYgbm90LCB0aHJvd3MgRXJyb3JcbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9XG4gICAqIEBwYXJhbSB7Kn0gZGF0YVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3RhdGljIF9jaGVja0ZvclVpbnQ4QXJyYXkoZGF0YSkge1xuICAgIGlmICghKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRGF0YSBub3QgYnl0ZSBhcnJheSFcIik7XG4gICAgfVxuICB9XG59XG5cbi8qKiBFeHBvcnRzICoqL1xuZXhwb3J0IGRlZmF1bHQgSlNIZXhpO1xuIl19